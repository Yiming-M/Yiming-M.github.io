{"version":3,"sources":["file:///Users/yiming/Documents/Hugo-GitHub-Pages/themes/minimal-academic/assets/js/main.js"],"sourcesContent":["(function() {\n  const htmlElement = document.documentElement;\n\n  // 1. 设置主题的函数\n  function setTheme(theme) {\n    console.log('跟随系统设置主题为:', theme);\n    \n    if (theme === 'dark') {\n      htmlElement.setAttribute('data-theme', 'dark');\n    } else {\n      htmlElement.removeAttribute('data-theme');\n    }\n  }\n\n  // 2. 获取当前系统主题偏好\n  function getSystemTheme() {\n    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;\n    return prefersDark ? 'dark' : 'light';\n  }\n\n  // 3. 页面加载时的主题初始化\n  function initializeTheme() {\n    const systemTheme = getSystemTheme();\n    setTheme(systemTheme);\n  }\n\n  // 4. 监听系统主题变化并自动切换\n  function setupSystemThemeListener() {\n    const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');\n    \n    function handleSystemThemeChange(e) {\n      const newTheme = e.matches ? 'dark' : 'light';\n      setTheme(newTheme);\n      console.log('系统主题已更改，网站已自动同步到:', newTheme);\n    }\n    \n    mediaQuery.addEventListener('change', handleSystemThemeChange);\n  }\n\n  // 5. 左侧栏折叠功能（平板端和移动端）\n  function setupSidebarToggle() {\n    // 检查是否在平板端或移动端\n    const isTablet = window.innerWidth \u003e= 769 \u0026\u0026 window.innerWidth \u003c= 1024;\n    const isMobile = window.innerWidth \u003c= 768;\n    \n    if (!isTablet \u0026\u0026 !isMobile) return;\n\n    // 检查是否已经存在按钮，如果存在则不再创建\n    if (document.querySelector('.sidebar-toggle')) {\n      console.log('sidebar-toggle按钮已存在');\n      return;\n    }\n\n    // 创建左侧栏切换按钮\n    const sidebarToggle = document.createElement('button');\n    sidebarToggle.className = 'sidebar-toggle';\n    sidebarToggle.innerHTML = 'ℹ️';\n    sidebarToggle.setAttribute('aria-label', 'Toggle sidebar');\n    sidebarToggle.setAttribute('title', 'Toggle sidebar');\n    document.body.appendChild(sidebarToggle);\n    console.log('创建了sidebar-toggle按钮');\n\n    // 创建遮罩层\n    const sidebarOverlay = document.createElement('div');\n    sidebarOverlay.className = 'sidebar-overlay';\n    document.body.appendChild(sidebarOverlay);\n\n    // 获取左侧栏\n    const sidebarLeft = document.querySelector('.sidebar-left');\n    if (!sidebarLeft) return;\n\n    // 切换左侧栏显示状态\n    function toggleSidebar() {\n      const isActive = sidebarLeft.classList.contains('active');\n      \n      if (isActive) {\n        // 隐藏左侧栏\n        sidebarLeft.classList.remove('active');\n        sidebarOverlay.classList.remove('active');\n        document.body.style.overflow = '';\n      } else {\n        // 显示左侧栏\n        sidebarLeft.classList.add('active');\n        sidebarOverlay.classList.add('active');\n        document.body.style.overflow = 'hidden';\n      }\n    }\n\n    // 隐藏左侧栏\n    function hideSidebar() {\n      sidebarLeft.classList.remove('active');\n      sidebarOverlay.classList.remove('active');\n      document.body.style.overflow = '';\n    }\n\n    // 绑定事件\n    sidebarToggle.addEventListener('click', function(e) {\n      e.stopPropagation();\n      toggleSidebar();\n    });\n\n    // 点击遮罩层隐藏左侧栏\n    sidebarOverlay.addEventListener('click', hideSidebar);\n\n    // 点击左侧栏内部不隐藏\n    sidebarLeft.addEventListener('click', function(e) {\n      e.stopPropagation();\n    });\n\n    // 点击页面其他区域隐藏左侧栏\n    document.addEventListener('click', function(e) {\n      if (!sidebarLeft.contains(e.target) \u0026\u0026 !sidebarToggle.contains(e.target)) {\n        hideSidebar();\n      }\n    });\n\n    // 监听窗口大小变化\n    window.addEventListener('resize', function() {\n      const isTablet = window.innerWidth \u003e= 769 \u0026\u0026 window.innerWidth \u003c= 1024;\n      const isMobile = window.innerWidth \u003c= 768;\n      if (!isTablet \u0026\u0026 !isMobile) {\n        hideSidebar();\n      }\n    });\n  }\n\n  // 6. 移动端搜索功能\n  function setupMobileSearch() {\n    // 检查是否在移动端\n    const isMobile = window.innerWidth \u003c= 768;\n    if (!isMobile) return;\n\n    const searchToggle = document.getElementById('search-toggle');\n    const mobileSearchOverlay = document.getElementById('mobile-search-overlay');\n    const mobileSearchClose = document.getElementById('mobile-search-close');\n    const mobileSearchInput = document.getElementById('mobile-search-input');\n    const mobileSearchResults = document.getElementById('mobile-search-results');\n\n    if (!searchToggle || !mobileSearchOverlay) return;\n\n    // 显示搜索弹窗\n    function showSearchOverlay() {\n      mobileSearchOverlay.style.display = 'flex';\n      if (mobileSearchInput) {\n        mobileSearchInput.focus();\n      }\n      document.body.style.overflow = 'hidden';\n    }\n\n    // 隐藏搜索弹窗\n    function hideSearchOverlay() {\n      mobileSearchOverlay.style.display = 'none';\n      if (mobileSearchInput) {\n        mobileSearchInput.value = '';\n      }\n      if (mobileSearchResults) {\n        mobileSearchResults.innerHTML = '';\n      }\n      document.body.style.overflow = '';\n    }\n\n    // 搜索功能\n    function performSearch(query) {\n      if (!query.trim()) {\n        if (mobileSearchResults) {\n          mobileSearchResults.innerHTML = '';\n        }\n        return;\n      }\n\n      // 获取所有文章\n      const posts = document.querySelectorAll('.post-card');\n      const results = [];\n\n      posts.forEach(post =\u003e {\n        // 搜索标题\n        const title = post.querySelector('.post-header h2')?.textContent || '';\n        \n        // 搜索正文内容\n        const content = post.querySelector('.post-content')?.textContent || '';\n        \n        // 搜索meta部分 - 日期\n        const dateElement = post.querySelector('time');\n        const date = dateElement ? dateElement.textContent : '';\n        \n        // 搜索meta部分 - venue\n        const venueElements = post.querySelectorAll('.tag-venue');\n        const venues = Array.from(venueElements).map(tag =\u003e tag.textContent).join(' ');\n        \n        // 搜索meta部分 - keywords\n        const keywordElements = post.querySelectorAll('.tag-keyword');\n        const keywords = Array.from(keywordElements).map(tag =\u003e tag.textContent).join(' ');\n        \n        // 搜索meta部分 - 其他可能的meta信息\n        const metaElements = post.querySelectorAll('.post-meta *');\n        const metaText = Array.from(metaElements).map(el =\u003e el.textContent).join(' ');\n\n        // 组合所有可搜索的文本\n        const searchText = `${title} ${content} ${date} ${venues} ${keywords} ${metaText}`.toLowerCase();\n        const queryLower = query.toLowerCase();\n\n        if (searchText.includes(queryLower)) {\n          results.push({\n            title: title,\n            element: post,\n            date: date,\n            venue: venues,\n            keywords: keywords\n          });\n        }\n      });\n\n      // 显示搜索结果\n      if (mobileSearchResults) {\n        if (results.length === 0) {\n          mobileSearchResults.innerHTML = '\u003cdiv class=\"no-results\"\u003eNo results found\u003c/div\u003e';\n        } else {\n          mobileSearchResults.innerHTML = results.map(result =\u003e {\n            const postId = result.element.querySelector('.post-header')?.getAttribute('data-post-id');\n            return `\u003cdiv class=\"search-result-item\" data-post-id=\"${postId}\"\u003e\n              \u003cdiv class=\"search-result-title\"\u003e\u003cstrong\u003e${result.title}\u003c/strong\u003e\u003c/div\u003e\n              ${result.date ? `\u003cdiv class=\"search-result-meta\"\u003e📅 ${result.date}\u003c/div\u003e` : ''}\n              ${result.venue ? `\u003cdiv class=\"search-result-meta\"\u003e📄 ${result.venue}\u003c/div\u003e` : ''}\n              ${result.keywords ? `\u003cdiv class=\"search-result-meta\"\u003e🏷️ ${result.keywords.split(' ').slice(0, 3).join(', ')}${result.keywords.split(' ').length \u003e 3 ? '...' : ''}\u003c/div\u003e` : ''}\n            \u003c/div\u003e`;\n          }).join('');\n          \n          // 为搜索结果添加点击事件\n          mobileSearchResults.querySelectorAll('.search-result-item').forEach((item, index) =\u003e {\n            item.addEventListener('click', () =\u003e {\n              const targetPost = results[index].element;\n              if (window.expandAndCenterPost) {\n                window.expandAndCenterPost(targetPost);\n              }\n              hideSearchOverlay();\n            });\n          });\n        }\n      }\n    }\n\n    // 绑定事件\n    searchToggle.addEventListener('click', showSearchOverlay);\n    mobileSearchClose.addEventListener('click', hideSearchOverlay);\n\n    // 点击遮罩层关闭搜索\n    mobileSearchOverlay.addEventListener('click', function(e) {\n      if (e.target === mobileSearchOverlay) {\n        hideSearchOverlay();\n      }\n    });\n\n    // 搜索输入事件\n    if (mobileSearchInput) {\n      mobileSearchInput.addEventListener('input', function() {\n        performSearch(this.value);\n      });\n\n      // 回车键搜索\n      mobileSearchInput.addEventListener('keypress', function(e) {\n        if (e.key === 'Enter') {\n          performSearch(this.value);\n        }\n      });\n    }\n\n    // ESC键关闭搜索\n    document.addEventListener('keydown', function(e) {\n      if (e.key === 'Escape' \u0026\u0026 mobileSearchOverlay.style.display === 'flex') {\n        hideSearchOverlay();\n      }\n    });\n  }\n\n  // 7. 初始化：设置初始主题并开始监听系统变化\n  initializeTheme();\n  setupSystemThemeListener();\n  \n  // 8. 初始化功能\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', function() {\n      setupSidebarToggle();\n      setupMobileSearch();\n    });\n  } else {\n    setupSidebarToggle();\n    setupMobileSearch();\n  }\n\n  // 9. 监听窗口大小变化，重新初始化功能\n  window.addEventListener('resize', function() {\n    setupSidebarToggle();\n    setupMobileSearch();\n  });\n})();\n"],"mappings":"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","names":["isTablet","isMobile"]}